// multi-view.js
if(window.isMultiViewInjected){console.log("Multi-View script already injected. Listening for new init message.")}else{window.isMultiViewInjected=!0;console.log("Multi-View content script loaded for the first time.")}
function initMultiView(urls){const existingContainer=document.getElementById('toolkit-multiview-container');if(existingContainer)existingContainer.remove();const container=document.createElement('div');container.id='toolkit-multiview-container';Object.assign(container.style,{position:'fixed',top:'0',left:'0',width:'100vw',height:'100vh',zIndex:'2147483647',backgroundColor:'#333',display:'flex',gap:'5px',padding:'40px 5px 5px 5px',boxSizing:'border-box'});const devFrame=createIframe('Dev',urls.dev);const qaFrame=createIframe('QA',urls.qa);const prodFrame=createIframe('Prod',urls.prod);const header=document.createElement('div');Object.assign(header.style,{position:'absolute',top:'0',left:'0',width:'100%',height:'40px',backgroundColor:'#1a1a1a',color:'white',display:'flex',alignItems:'center',justifyContent:'space-between',padding:'0 15px',boxSizing:'border-box',fontFamily:'sans-serif'});const title=document.createElement('span');title.textContent='Multi-Environment View';title.style.fontWeight='bold';const closeButton=document.createElement('button');closeButton.textContent='Exit Multi-View (Esc)';Object.assign(closeButton.style,{padding:'5px 10px',cursor:'pointer',border:'1px solid #555',backgroundColor:'#444',color:'white',borderRadius:'4px'});const exitMultiView=()=>{container.remove();document.body.style.overflow='auto';window.removeEventListener('keydown',handleEscKey)};closeButton.onclick=exitMultiView;header.appendChild(title);header.appendChild(closeButton);container.appendChild(header);container.appendChild(devFrame);container.appendChild(qaFrame);container.appendChild(prodFrame);document.body.appendChild(container);document.body.style.overflow='hidden';const handleEscKey=event=>{if(event.key==='Escape')exitMultiView()};window.addEventListener('keydown',handleEscKey)}
function createIframe(label,src){const wrapper=document.createElement('div');Object.assign(wrapper.style,{flex:'1',display:'flex',flexDirection:'column',position:'relative',border:'1px solid #555',backgroundColor:'#111'});const labelDiv=document.createElement('div');labelDiv.textContent=label;Object.assign(labelDiv.style,{position:'absolute',top:'5px',left:'5px',padding:'3px 6px',backgroundColor:'rgba(0, 0, 0, 0.7)',color:'white',fontSize:'12px',borderRadius:'3px',zIndex:'1'});const iframe=document.createElement('iframe');iframe.src=src;Object.assign(iframe.style,{width:'100%',height:'100%',border:'none'});wrapper.appendChild(labelDiv);wrapper.appendChild(iframe);return wrapper}
chrome.runtime.onMessage.addListener((request,sender,sendResponse)=>{if(request.action==='initMultiView'){initMultiView(request.urls);sendResponse({status:"Multi-View displayed"})}});